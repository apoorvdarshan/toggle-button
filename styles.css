/* Theme variables and sizes */
:root {
  /* Sizes */
  --track-w: 340px;
  --track-h: 150px;
  --knob: 120px;
  --gap: 12px; /* horizontal padding inside track */

  /* Colors (light by default) */
  --bg-color: #f5f6fa;
  --fg-color: #111827;
  --track-off: #e5e7eb;
  --track-on: #34c759;
  --knob-bg: #f9fafb;
  --shadow-strong: rgba(0,0,0,0.18);
  --shadow-soft: rgba(0,0,0,0.10);

  /* Track artwork (light mode) */
  --track-img: url('assets/anakin skywalker.jpg');
}

body.theme-dark {
  --bg-color: #0b1020;
  --fg-color: #e5e7eb;
  --track-off: #3b3f46;
  --track-on: #2ecc71;
  --knob-bg: #1a1f2e;
  --shadow-strong: rgba(0,0,0,0.55);
  --shadow-soft: rgba(0,0,0,0.35);
  /* Track artwork (dark mode) */
  --track-img: url('assets/death wader.jpeg');
}

html, body { height: 100%; }

body {
  margin: 0;
  color: var(--fg-color);
  background: var(--bg-color);
  transition: background 300ms ease, color 300ms ease;
  display: grid;
  place-items: center;
  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
  position: relative;
  overflow: hidden;
}

/* Ambient background animation (outside) */
body::before {
  content: "";
  position: fixed;
  inset: -20vmax;
  z-index: -1;
  background: radial-gradient(60vmax 60vmax at 30% 20%, rgba(255,255,255,0.7), rgba(255,255,255,0) 60%),
              radial-gradient(70vmax 70vmax at 80% 70%, rgba(255,200,150,0.25), rgba(255,255,255,0) 60%);
  filter: blur(30px) saturate(1.05);
  transform: translateZ(0);
  animation: floatLight 16s ease-in-out infinite alternate;
  pointer-events: none;
}

body.theme-dark::before {
  background:
    radial-gradient(60vmax 60vmax at 30% 20%, rgba(76,29,149,0.25), rgba(0,0,0,0) 60%),
    radial-gradient(70vmax 70vmax at 80% 70%, rgba(14,165,233,0.18), rgba(0,0,0,0) 60%),
    radial-gradient(1px 1px at 10% 20%, rgba(255,255,255,0.75) 1px, transparent 1.2px),
    radial-gradient(1px 1px at 20% 80%, rgba(255,255,255,0.55) 1px, transparent 1.2px),
    radial-gradient(1px 1px at 60% 30%, rgba(255,255,255,0.85) 1px, transparent 1.2px),
    radial-gradient(1px 1px at 75% 60%, rgba(255,255,255,0.65) 1px, transparent 1.2px);
  opacity: 0.9;
  animation: floatDark 18s ease-in-out infinite alternate;
}

@keyframes floatLight {
  from { transform: translate(-2%, -2%) scale(1); }
  to   { transform: translate(2%, 1%) scale(1.05); }
}

@keyframes floatDark {
  from { transform: translate(1%, 2%) scale(1.02); }
  to   { transform: translate(-1%, -1%) scale(1.06); }
}

/* Visually hidden but accessible checkbox */
.visually-hidden {
  position: absolute !important;
  width: 1px; height: 1px;
  padding: 0; margin: -1px;
  overflow: hidden; clip: rect(0 0 0 0);
  white-space: nowrap; border: 0;
}

.wrap { text-align: center; }

/* Track (the switch background) */
.toggle {
  position: relative;
  width: var(--track-w);
  height: var(--track-h);
  border-radius: calc(var(--track-h) / 2);
  background-color: var(--track-off);
  background-image: var(--track-img);
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  cursor: pointer;
  display: inline-block;
  box-shadow:
    inset 0 10px 16px var(--shadow-soft),
    inset 0 -10px 16px rgba(255,255,255,0.75);
  transition: background 240ms ease, box-shadow 240ms ease, transform 200ms ease;
  overflow: hidden; /* clip background to rounded track */
}

/* Moving shine inside the track (inside animation) */
.toggle::after {
  content: "";
  position: absolute;
  inset: 0;
  border-radius: inherit;
  background: linear-gradient(100deg, rgba(255,255,255,0) 30%, rgba(255,255,255,0.18) 45%, rgba(255,255,255,0) 60%);
  background-size: 200% 100%;
  animation: sweep 2.6s linear infinite;
  pointer-events: none;
  mix-blend-mode: screen;
}

@keyframes sweep {
  0%   { background-position: 200% 0; }
  100% { background-position: -200% 0; }
}

/* Outer glow pulse (outside animation) */
.toggle::before {
  content: "";
  position: absolute;
  inset: -14px;
  border-radius: inherit;
  background: radial-gradient(80% 80% at 50% 50%, rgba(52,199,89,0.35), rgba(52,199,89,0) 70%);
  opacity: 0;
  transform: scale(0.98);
  filter: blur(6px);
  transition: opacity 200ms ease, transform 200ms ease;
  pointer-events: none;
}

/* Knob */
.knob {
  position: absolute;
  top: 50%; left: var(--gap);
  width: var(--knob);
  height: var(--knob);
  border-radius: 999px;
  background: var(--knob-bg);
  transform: translate(0, -50%);
  box-shadow:
    0 16px 26px var(--shadow-soft),
    inset 0 1px 0 rgba(255,255,255,0.95);
  display: grid;
  place-items: center;
  overflow: hidden;
  transition: transform 260ms cubic-bezier(.2,.8,.2,1), background 220ms ease, box-shadow 220ms ease;
}

/* Sun/Moon icons inside knob */
.icon { position: absolute; width: 58%; height: 58%; transition: opacity 240ms ease, transform 400ms ease; }
.sun  { opacity: 1;  transform: rotate(0deg) scale(1); }
.moon { opacity: 0;  transform: rotate(-30deg) scale(0.8); }

/* Checked state */
#big-toggle:checked + .toggle {
  /* keep the image; just adjust shading when ON */
  box-shadow:
    inset 0 6px 14px rgba(0,0,0,0.1),
    inset 0 -10px 18px rgba(255,255,255,0.5);
}

#big-toggle:checked + .toggle::before { opacity: 1; transform: scale(1); }

#big-toggle:checked + .toggle .knob {
  transform: translate(calc(var(--track-w) - var(--knob) - var(--gap) * 2), -50%);
  background: #ffffff;
}

#big-toggle:checked + .toggle .sun  { opacity: 0; transform: rotate(90deg) scale(0.8); }
#big-toggle:checked + .toggle .moon { opacity: 1; transform: rotate(0deg)  scale(1); }

/* Dark mode stars inside the track */
body.theme-dark #big-toggle:checked + .toggle::after {
  background:
    radial-gradient(1.5px 1.5px at 25% 30%, rgba(255,255,255,0.9) 1.5px, transparent 1.7px),
    radial-gradient(1.2px 1.2px at 55% 65%, rgba(255,255,255,0.7) 1.2px, transparent 1.4px),
    radial-gradient(1px 1px at 70% 40%, rgba(255,255,255,0.85) 1px, transparent 1.2px);
  animation: twinkle 2.2s ease-in-out infinite;
  mix-blend-mode: normal;
}

@keyframes twinkle {
  0%, 100% { opacity: 0.6; }
  50%      { opacity: 1; }
}

/* Keyboard focus */
#big-toggle:focus-visible + .toggle { outline: 4px solid rgba(0, 120, 255, 0.6); outline-offset: 6px; }

/* Optional helper text */
.hint { margin-top: 20px; color: #6b7280; font-size: 14px; text-align: center; }

/* Reduced motion */
@media (prefers-reduced-motion: reduce) {
  body::before, .toggle::after { animation: none !important; }
  .toggle, .knob { transition: none !important; }
}
